# Развертывание Apache Kafka с Docker для тестирования

![docker_new.png](https://github.com/Ewerall/QA-Portfolio/blob/main/Infrastructure/Kafka-Docker/docker_new.png "docker_new.png")

В этой папке показан docker-compose.yml для поднятия Apache Kafka и последующего тестирования event-driven архитектуры. Я реализовал простую конфигурацию Docker и Docker Compose, которая подходит для разработки и тестирования микросервисных приложений.

## Почему именно такой подход?

Выбор Docker для развертывания Kafka обусловлен несколькими ключевыми преимуществами:

-   **Изоляция среды**: Отсутствие конфликтов с другими сервисами на хосте
-   **Повторяемость**: Тождественные среды для всего проекта
-   **Простота настройки**: Всего один файл конфигурации вместо сложной ручной установки

## Архитектура

Реализация включает два основных компонента:

1.  **Zookeeper** - координирующий сервис для управления кластером Kafka
2.  **Kafka Broker** - основной сервер для обработки потоков событий

Оба компонента развернуты как отдельные Docker-контейнеры, связанные через внутреннюю сеть Docker Compose.

## Ключевые особенности конфигурации

В моей реализации я применил следующие настройки:

-   **Использование официальных образов Confluent Platform 7.0.0** 
-   **Одноброкерная установка** (KAFKA_BROKER_ID: 1) - оптимально для тестовой среды
-   **Локальное пробрасывание порта** (9092:9092) - позволяет тестам подключаться напрямую к Kafka
-   **Настройка advertised listeners** (PLAINTEXT://localhost:9092) - критически важна для корректной работы с локальными тестами
-   **Пониженный replication factor** (1) - адаптировано для одноброкерной среды разработки

## Преимущества

Решение имеет несколько важных преимуществ:

-   **Минимальные требования к ресурсам** - запускается даже на ноутбуках (Мой случай)
-   **Полная автономность** - не требует внешних зависимостей
-   **Быстрое развертывание** - всего одна команда для старта всей инфраструктуры
-   **Совместимость с тестовой средой** - параметры точно соответствуют настройкам в моих автотестах
-   **Отсутствие "мусора" на хосте** - все компоненты изолированы в контейнерах

## Особенности настройки для QA

Я внёс несколько оптимизаций именно для тестирования:

-   **Установлен auto_offset_reset='earliest'** - позволяет тестам всегда получать все сообщения с начала
-   **Настроенные таймауты** - предотвращают зависание тестов при проблемах с доставкой
-   **Динамические group_id** - обеспечивают изоляцию тестовых прогонов
-   **Отключены избыточные проверки репликации** - ускоряет обработку сообщений в тестовой среде

## Процесс развертывания

Максимально простой процесс развертывания:

1.  Создание `docker-compose.yml` с оптимизированной конфигурацией
2.  Запуск контейнеров одной командой `docker-compose up -d`
3.  Автоматическая инициализация всех компонентов
4.  Готовая к работе Kafka-среда в течение 15-30 секунд
